@using SFA.DAS.EAS.Domain.Models.Organisation
@using SFA.DAS.EAS.Web.Extensions
@using SFA.DAS.EAS.Web.ViewModels.Organisation
@model SFA.DAS.EAS.Web.OrchestratorResponse<SearchOrganisationViewModel>

@{ 
    ViewBag.PageID = "select-your-organisation";
    ViewBag.Title = "Select your organisation";
    ViewBag.HideNav = "true";
}

<div class="grid-row">
    <div class="column-two-thirds">
        <h1 class="heading-xlarge">@ViewBag.Title</h1>
        <form action="@Url.Action("SearchForOrganisationResults")" method="POST">
            <div class="search-field">
                <fieldset class="search-input">
                    <label for="searchTerm">
                        <span class="form-label-bold">Search results</span>
                    </label>
                    <input type="text" id="searchTerm" name="searchTerm" value="@Model.Data.SearchTerm" class="form-control" />
                </fieldset>
                <fieldset class="search-submit">
                    <button type="submit" class="button">Search</button>
                </fieldset>
            </div>
        </form>
        <p>@(Model.Data?.Results.TotalResults ?? 0) results found</p>
    </div>
</div>

<div class="grid-row search-results">
    <aside>
        <h2 class="heading-medium">Filter results</h2>
        <form action="@Url.Action("SearchForOrganisationResults")?searchTerm=@Model.Data.SearchTerm" method="POST">
            <div class="filter">
                <h3>Organisation type</h3>
                <label class="block-label selection-button-radio" for="company">
                    <input id="company" type="radio" name="organisationType" value="CompaniesHouse" @(Model.Data.OrganisationType == OrganisationType.CompaniesHouse ? "checked=\"checked\"" : "") /> Company
                </label>
                <label class="block-label selection-button-radio" for="charity">
                    <input id="charity" type="radio" name="organisationType" value="Charities" @(Model.Data.OrganisationType == OrganisationType.Charities ? "checked=\"checked\"" : "") /> Charity
                </label>
                <label class="block-label selection-button-radio" for="publicSector">
                    <input id="publicSector" type="radio" name="organisationType" value="PublicBodies" @(Model.Data.OrganisationType == OrganisationType.PublicBodies ? "checked=\"checked\"" : "") /> Public sector & other
                </label>
                <label class="block-label selection-button-radio" for="all">
                    <input id="all" type="radio" name="organisationType" value="" @(Model.Data.OrganisationType == null ? "checked=\"checked\"" : "") /> Show all
                </label>
                <div class="form-group" id="apply-filter">
                    <button type="submit" class="button-secondary">Apply filter</button>
                </div>
            </div>
         
        </form>
    </aside>
    <section class="results-list">
        

            @if (Model.Data != null)
            {
                <ol>
                @foreach (var organisation in Model.Data.Results.Data)
                {
                    <li>
                        <article>
                            <form action="@Url.Action("SelectOrganisation")" method="post">
                                <input type="hidden" name="DateOfInception" value="@organisation.RegistrationDate" />
                                <input type="hidden" name="OrganisationCode" value="@organisation.Code" />
                                <input type="hidden" name="Sector" value="@organisation.Sector" />
                                <input type="hidden" name="Type" value="@organisation.Type" />
                                <input type="hidden" name="Name" value="@organisation.Name" />
                                <input type="hidden" name="Address" value="@organisation.Address.GetAddress()" />
                                <button type="submit" class="heading-medium link-button">@organisation.Name</button>
                            </form>
                           
                            <dl class="inline">
                                <dt>Address</dt>
                                @{
                                    var address = organisation.Address.GetAddress();
                                }
                                <dd>@(string.IsNullOrEmpty(address) ? "No address supplied" : address)</dd>
                                <dt>Type</dt>
                                <dd>@organisation.Type.GetDescription()</dd>
                            </dl>
                        </article>
                    </li>
                }
                </ol>
            }
            else
            {
                 <p>No results found</p>
            }

            

            @*<li class="added">
                <article>
                    <h1 class="heading-medium">20-20 Housing Co-operative Limited</h1>
                    <dl class="inline">
                        <dt>Address</dt>
                        <dd>123 Some Street, Tiny Town, AB1 2CD</dd>
                        <dt>Type</dt>
                        <dd>Private limited company</dd>
                    </dl>
                    <p>Already added - <a href="">view my organisations</a>
                    </p>
                </article>
            </li>*@
            
        
        <nav>
            <ul class="previous-next-navigation">
                @if (Model.Data.Results.PageNumber > 1)
                {
                    <li class="previous">
                        <a href="@Url.Action("SearchForOrganisationResults", new {searchTerm = Model.Data.SearchTerm, pageNumber = Model.Data.Results.PageNumber - 1, organisationType = Model.Data.OrganisationType })">
                            Previous page
                            <span class="detail">Page @(Model.Data.Results.PageNumber - 1) of @Model.Data.Results.TotalPages</span>
                        </a>
                    </li>
                }
                @if (Model.Data.Results.PageNumber < Model.Data.Results.TotalPages)
                {
                    <li class="next">
                        <a href="@Url.Action("SearchForOrganisationResults", new {searchTerm = Model.Data.SearchTerm, pageNumber = Model.Data.Results.PageNumber + 1, organisationType = Model.Data.OrganisationType })">
                            Next page
                            <span class="detail">Page @(Model.Data.Results.PageNumber + 1) of @Model.Data.Results.TotalPages</span>
                        </a>
                    </li>
                }
            </ul>
        </nav>
    </section>

   
</div>

@section breadcrumb {
    <div class="breadcrumbs">
        <a href="@Url.Action("Index", "Home")" class="link-back">Back</a>
    </div>
}